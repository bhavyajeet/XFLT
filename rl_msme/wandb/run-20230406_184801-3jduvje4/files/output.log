
[38mic| model_gpus: [1]
[38mic| next(model.parameters()).is_cuda: True
[38mic| start_epoch: 0, final_checkpoint: None
  0%|                                                                                                                                                                           | 0/5 [00:00<?, ?it/s]
  next_tokens.tile(eos_token_id_tensor.shape[0], 1).ne(eos_token_id_tensor.unsqueeze(1)).prod(dim=0)                                                                        | 0/22622 [00:00<?, ?it/s]
  0%|                                                                                                                                                                       | 0/22622 [00:03<?, ?it/s]
  0%|                                                                                                                                                                           | 0/5 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "train_ddp.py", line 409, in <module>
    main()
  File "train_ddp.py", line 324, in main
    middle_output = model.module.middle(batch)
  File "/home2/aditya_hari/multisent/MEMS-XF2T/rl_msme/model/model_ddp.py", line 94, in middle
    return {'main_loss': sum(loss)/len(loss), 'logits': logits, 'input_text': input_text, 'pred_text': pred_text}
  File "/home2/aditya_hari/miniconda3/envs/multisent/lib/python3.7/site-packages/torch/_tensor.py", line 916, in __iter__
    raise TypeError("iteration over a 0-d tensor")
TypeError: iteration over a 0-d tensor