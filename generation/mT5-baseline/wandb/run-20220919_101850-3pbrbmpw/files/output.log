09/19/2022 10:18:58 AM [INFO] val dataset count : 2435
Validation sanity check:  50% 1/2 [00:00<00:00,  6.61it/s]09/19/2022 10:18:58 AM [INFO] epoch : 0 - average_val_loss : 42.808235
09/19/2022 10:18:59 AM [INFO] train dataset count : 21909
Epoch 0:   0% 1/2892 [00:00<27:02,  1.78it/s, loss=42.041, v_num=bmpw]
Set SLURM handle signals.
  | Name  | Type                        | Params
------------------------------------------------------
0 | model | MT5ForConditionalGeneration | 300 M
/home2/manav.chaudhary/miniconda3/envs/xalign/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 40 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
/home2/manav.chaudhary/miniconda3/envs/xalign/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 40 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.



























































































































































































































































































































































































































































































































































Epoch 0:  96% 2786/2892 [18:02<00:41,  2.57it/s, loss=1.218, v_num=bmpw]


Validating:  91% 139/153 [00:05<00:00, 23.73it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 2738 < 2896; dropping {'avg_val_loss': 0.9342353343963623, 'epoch': 0}.

Validating:  99% 151/153 [00:06<00:00, 25.04it/s]
Epoch 0: 100% 2892/2892 [18:11<00:00,  2.65it/s, 09/19/2022 10:37:11 AM [INFO] epoch : 0 - average_train_loss : 1.988882





































































































































































































































































































































































































































































































































































Epoch 1:  96% 2778/2892 [18:23<00:45,  2.52it/s, loss=0.912, v_num=bmpw, avg_val_loss=0.934, avg_train_loss=1.99]


Validating:  87% 133/153 [00:05<00:00, 26.86it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 5477 < 5790; dropping {'avg_val_loss': 0.7756885290145874, 'epoch': 1}.

Validating:  99% 151/153 [00:06<00:00, 26.95it/s]
Epoch 1: 100% 2892/2892 [18:32<00:00,  2.60it/s, 09/19/2022 10:55:44 AM [INFO] epoch : 1 - average_train_loss : 0.935404
































































































































































































































































































































































































































































































































































Epoch 2:  95% 2742/2892 [18:13<00:59,  2.51it/s, loss=0.678, v_num=bmpw, avg_val_loss=0.776, avg_train_loss=0.935]



Validating:  99% 151/153 [00:05<00:00, 26.93it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 8216 < 8684; dropping {'avg_val_loss': 0.7101643681526184, 'epoch': 2}.
Epoch 2: 100% 2892/2892 [18:23<00:00,  2.62it/s, 09/19/2022 11:14:07 AM [INFO] epoch : 2 - average_train_loss : 0.701091
Epoch 3:   0% 2/2892 [00:00<21:23,  2.25it/s, loss=0.638, v_num=bmpw, avg_val_loss=0.71, avg_train_loss=0.701]


























































































































































































































































































































































































































































































































































Epoch 3:  95% 2757/2892 [18:00<00:52,  2.55it/s, loss=0.404, v_num=bmpw, avg_val_loss=0.71, avg_train_loss=0.701]



Validating:  99% 151/153 [00:05<00:00, 22.40it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 10955 < 11578; dropping {'avg_val_loss': 0.6699843406677246, 'epoch': 3}.
Epoch 3: avg_val_loss reached 0.66998 (best 0.66998), saving model to /tmp/Axlign/checkpoint/te-google-mt5-small-5-0.001/epoch=3.ckpt as top 1
Epoch 3: 100% 2892/2892 [18:10<00:00,  2.65it/s, 09/19/2022 11:32:18 AM [INFO] epoch : 3 - average_train_loss : 0.549396






























































































































































































































































































































































































































































































































































Epoch 4:  95% 2742/2892 [18:09<00:59,  2.52it/s, loss=0.396, v_num=bmpw, avg_val_loss=0.67, avg_train_loss=0.549]



Validating:  99% 151/153 [00:06<00:00, 22.77it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 13694 < 14472; dropping {'avg_val_loss': 0.6629070043563843, 'epoch': 4}.
Epoch 4: avg_val_loss reached 0.66291 (best 0.66291), saving model to /tmp/Axlign/checkpoint/te-google-mt5-small-5-0.001/epoch=4.ckpt as top 1
Epoch 4: 100% 2892/2892 [18:19<00:00,  2.63it/s, 09/19/2022 11:50:39 AM [INFO] epoch : 4 - average_train_loss : 0.467396
Epoch 4: 100% 2892/2892 [18:20<00:00,  2.63it/s, loss=0.396, v_num=bmpw, avg_val_loss=0.663, avg_train_loss=0.549]
09/19/2022 11:50:41 AM [DEBUG] training done.