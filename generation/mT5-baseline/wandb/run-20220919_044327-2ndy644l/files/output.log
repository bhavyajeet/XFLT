09/19/2022 04:43:35 AM [INFO] val dataset count : 1941
Validation sanity check:  50% 1/2 [00:00<00:00,  6.73it/s]09/19/2022 04:43:35 AM [INFO] epoch : 0 - average_val_loss : 39.019295
09/19/2022 04:43:36 AM [INFO] train dataset count : 17467
Epoch 0:   0% 0/2306 [00:00<?, ?it/s]
Set SLURM handle signals.
  | Name  | Type                        | Params
------------------------------------------------------
0 | model | MT5ForConditionalGeneration | 300 M
/home2/manav.chaudhary/miniconda3/envs/xalign/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 40 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
/home2/manav.chaudhary/miniconda3/envs/xalign/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 40 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.































































































































































































































































































































































































































































































































































































Epoch 0:  97% 2234/2306 [19:14<00:37,  1.93it/s, loss=1.538, v_num=644l]

Validating:  82% 100/122 [00:04<00:00, 25.88it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 2183 < 2310; dropping {'avg_val_loss': 1.2055869102478027, 'epoch': 0}.

Validating:  99% 121/122 [00:04<00:00, 25.49it/s]
Epoch 0: 100% 2306/2306 [19:22<00:00,  1.98it/s, 09/19/2022 05:02:58 AM [INFO] epoch : 0 - average_train_loss : 3.123225




























































































































































































































































































































































































































































































































































































Epoch 1:  96% 2220/2306 [19:09<00:44,  1.93it/s, loss=0.892, v_num=644l, avg_val_loss=1.21, avg_train_loss=3.12]


Validating:  99% 121/122 [00:04<00:00, 25.84it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 4367 < 4618; dropping {'avg_val_loss': 0.8363492488861084, 'epoch': 1}.
Epoch 1: avg_val_loss reached 0.83635 (best 0.83635), saving model to /tmp/Axlign/checkpoint/mr-google-mt5-small-5-0.001/epoch=1.ckpt as top 1
Epoch 1: 100% 2306/2306 [19:17<00:00,  1.99it/s, 09/19/2022 05:22:16 AM [INFO] epoch : 1 - average_train_loss : 1.058866





























































































































































































































































































































































































































































































































































































Epoch 2:  96% 2211/2306 [19:11<00:49,  1.92it/s, loss=0.791, v_num=644l, avg_val_loss=0.836, avg_train_loss=1.06]


Validating:  99% 121/122 [00:04<00:00, 25.61it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 6551 < 6926; dropping {'avg_val_loss': 0.7214285731315613, 'epoch': 2}.
Epoch 2: 100% 2306/2306 [19:19<00:00,  1.99it/s, 09/19/2022 05:41:36 AM [INFO] epoch : 2 - average_train_loss : 0.777926
Epoch 3:   0% 0/2306 [00:00<?, ?it/s, loss=0.791, v_num=644l, avg_val_loss=0.721, avg_train_loss=1.06]






















































































































































































































































































































































































































































































































































































Epoch 3:  95% 2187/2306 [18:56<01:01,  1.92it/s, loss=0.831, v_num=644l, avg_val_loss=0.721, avg_train_loss=0.778]


Validating:  87% 106/122 [00:04<00:00, 26.15it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 8735 < 9234; dropping {'avg_val_loss': 0.6988991498947144, 'epoch': 3}.

Validating:  99% 121/122 [00:04<00:00, 26.20it/s]
Epoch 3: 100% 2306/2306 [19:06<00:00,  2.01it/s, 09/19/2022 06:00:42 AM [INFO] epoch : 3 - average_train_loss : 0.618517


























































































































































































































































































































































































































































































































































































Epoch 4:  96% 2217/2306 [19:04<00:45,  1.94it/s, loss=0.545, v_num=644l, avg_val_loss=0.699, avg_train_loss=0.619]

Validating:  70% 85/122 [00:03<00:01, 25.61it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step must only increase in log calls.  Step 10919 < 11542; dropping {'avg_val_loss': 0.6825551986694336, 'epoch': 4}.

Validating:  99% 121/122 [00:04<00:00, 26.18it/s]
Epoch 4: 100% 2306/2306 [19:13<00:00,  2.00it/s, 09/19/2022 06:19:56 AM [INFO] epoch : 4 - average_train_loss : 0.501431
Epoch 4: 100% 2306/2306 [19:13<00:00,  2.00it/s, loss=0.545, v_num=644l, avg_val_loss=0.683, avg_train_loss=0.619]
09/19/2022 06:19:58 AM [DEBUG] training done.